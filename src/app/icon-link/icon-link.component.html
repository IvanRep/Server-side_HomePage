<main>
    <div class="link" (mousedown)="clickLink($event)" *ngIf="link.getFolder()==0 else folderTemplate">
        <img src="{{link.getVisibleUrl()}}" />
        
        <span>{{link.getName()}}</span>
        <div>
            <svg *ngIf="!isEditMode else editLinkIcon" xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="512" height="512">
                <path d="M13.845,17.267l-3.262,3.262A5.028,5.028,0,0,1,3.472,13.42l3.262-3.265A1,1,0,0,0,5.319,8.741L2.058,12.006A7.027,7.027,0,0,0,12,21.943l3.262-3.262a1,1,0,0,0-1.414-1.414Z"/>
                <path d="M21.944,2.061A6.979,6.979,0,0,0,16.975,0h0a6.983,6.983,0,0,0-4.968,2.057L8.74,5.32a1,1,0,0,0,1.414,1.415l3.265-3.262A4.993,4.993,0,0,1,16.973,2h0a5.028,5.028,0,0,1,3.554,8.583l-3.262,3.262A1,1,0,1,0,18.68,15.26L21.942,12A7.037,7.037,0,0,0,21.944,2.061Z"/>
                <path d="M14.293,8.293l-6,6a1,1,0,1,0,1.414,1.414l6-6a1,1,0,0,0-1.414-1.414Z"/>
            </svg>
        </div>
        <ng-template #editLinkIcon>
            <svg xmlns="http://www.w3.org/2000/svg" id="lapiz" viewBox="0 0 24 24" width="512" height="512">
                <path d="M22.853,1.148a3.626,3.626,0,0,0-5.124,0L1.465,17.412A4.968,4.968,0,0,0,0,20.947V23a1,1,0,0,0,1,1H3.053a4.966,4.966,0,0,0,3.535-1.464L22.853,6.271A3.626,3.626,0,0,0,22.853,1.148ZM5.174,21.122A3.022,3.022,0,0,1,3.053,22H2V20.947a2.98,2.98,0,0,1,.879-2.121L15.222,6.483l2.3,2.3ZM21.438,4.857,18.932,7.364l-2.3-2.295,2.507-2.507a1.623,1.623,0,1,1,2.295,2.3Z"/>
            </svg>
        </ng-template>
    </div>

    <button id="delete" [ngClass]="{'isEditMode': isEditMode && !cantDelete}" (click)="deleteLink(deleteButton)" value="{{index}}" #deleteButton>
        <svg xmlns="http://www.w3.org/2000/svg" id="cruzar" viewBox="0 0 24 24" width="512" height="512">
            <path d="M23.707.293h0a1,1,0,0,0-1.414,0L12,10.586,1.707.293a1,1,0,0,0-1.414,0h0a1,1,0,0,0,0,1.414L10.586,12,.293,22.293a1,1,0,0,0,0,1.414h0a1,1,0,0,0,1.414,0L12,13.414,22.293,23.707a1,1,0,0,0,1.414,0h0a1,1,0,0,0,0-1.414L13.414,12,23.707,1.707A1,1,0,0,0,23.707.293Z"/>
        </svg>
    </button>
    <button id="new" [ngClass]="{'isEditMode': isEditMode}" (click)="this.createNewLink(newButton)" value="{{index}}" #newButton>+</button>
</main>

<ng-template #folderTemplate>
    <a (click)="showFolder()" #folder>
        <div class="carpeta" [ngClass]="{'showLinks' : showLinks}">
            <img *ngFor="let folderLink of this.link.getLinks(), index as i" src="{{folderLink.getVisibleUrl()}}" />
            <div>
                <svg *ngIf="!showLinks else svgShowLinks" xmlns="http://www.w3.org/2000/svg" id="arrow-circle-down" viewBox="0 0 24 24" width="512" height="512">
                    <path d="M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm0,22A10,10,0,1,1,22,12,10.011,10.011,0,0,1,12,22Z"/>
                    <path d="M12,16a2.993,2.993,0,0,1-1.987-.752c-.327-.291-.637-.574-.84-.777L6.3,11.647a1,1,0,0,1,1.4-1.426L10.58,13.05c.188.187.468.441.759.7a1,1,0,0,0,1.323,0c.29-.258.57-.512.752-.693L16.3,10.221a1,1,0,1,1,1.4,1.426l-2.879,2.829c-.2.2-.507.48-.833.769A2.99,2.99,0,0,1,12,16Z"/>
                </svg>
                <ng-template #svgShowLinks>
                    <svg xmlns="http://www.w3.org/2000/svg" id="arrow-circle-down" viewBox="0 0 24 24" width="512" height="512">
                        <path d="M12,24A12,12,0,1,0,0,12,12.013,12.013,0,0,0,12,24ZM12,2A10,10,0,1,1,2,12,10.011,10.011,0,0,1,12,2Z"/>
                        <path d="M12,8a2.993,2.993,0,0,1,1.987.752c.327.291.637.574.84.777L17.7,12.353a1,1,0,1,1-1.4,1.426L13.42,10.95c-.188-.187-.468-.441-.759-.7a1,1,0,0,0-1.323,0c-.29.258-.57.512-.752.693L7.7,13.779a1,1,0,0,1-1.4-1.426L9.178,9.524c.2-.2.507-.48.833-.769A2.99,2.99,0,0,1,12,8Z"/>
                    </svg>
                </ng-template>
            </div>
        </div>
    </a>
    <!-- Links desplegables -->
    <div class="folder-links" [ngClass]="{'showLinks': showLinks}" #folderLinks>
        <div *ngFor="let folderLink of this.link.getLinks(), index as i">
            <div class="folderLink" (mousedown)="clickFolderLink($event, i)" [ngClass]="{'isEditMode':isEditMode}">
                <img src="{{folderLink.getVisibleUrl()}}" title="{{folderLink.getName()}}"/>
                <div *ngIf="!isEditMode || cantDelete else editLink" >{{folderLink.getName()}}</div>
                <ng-template #editLink>
                    <div>{{folderLink.getName()}}</div>
                    <svg xmlns="http://www.w3.org/2000/svg" id="Outline" viewBox="0 0 24 24" width="512" height="512" (mousedown)="editFolderLink(i)">
                        <path d="M22.853,1.148a3.626,3.626,0,0,0-5.124,0L1.465,17.412A4.968,4.968,0,0,0,0,20.947V23a1,1,0,0,0,1,1H3.053a4.966,4.966,0,0,0,3.535-1.464L22.853,6.271A3.626,3.626,0,0,0,22.853,1.148ZM5.174,21.122A3.022,3.022,0,0,1,3.053,22H2V20.947a2.98,2.98,0,0,1,.879-2.121L15.222,6.483l2.3,2.3ZM21.438,4.857,18.932,7.364l-2.3-2.295,2.507-2.507a1.623,1.623,0,1,1,2.295,2.3Z"/>
                    </svg>
                </ng-template>
                <button  *ngIf="isEditMode && !cantDelete" (click)="deleteFolderLink($event,deleteButton)" value="{{i}}" #deleteButton>
                    <svg xmlns="http://www.w3.org/2000/svg" id="Outline" viewBox="0 0 24 24" width="512" height="512">
                        <path d="M21,4H17.9A5.009,5.009,0,0,0,13,0H11A5.009,5.009,0,0,0,6.1,4H3A1,1,0,0,0,3,6H4V19a5.006,5.006,0,0,0,5,5h6a5.006,5.006,0,0,0,5-5V6h1a1,1,0,0,0,0-2ZM11,2h2a3.006,3.006,0,0,1,2.829,2H8.171A3.006,3.006,0,0,1,11,2Zm7,17a3,3,0,0,1-3,3H9a3,3,0,0,1-3-3V6H18Z"/>
                        <path d="M10,18a1,1,0,0,0,1-1V11a1,1,0,0,0-2,0v6A1,1,0,0,0,10,18Z"/>
                        <path d="M14,18a1,1,0,0,0,1-1V11a1,1,0,0,0-2,0v6A1,1,0,0,0,14,18Z"/>
                    </svg>
                </button>
            </div>
        </div>
        <div class="folderLink addLink" (click)="this.addLinkPopUp($event)" [ngClass]="{'isEditMode': isEditMode && !cantDelete && link.getLinks().length<6}">
            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000">
                <path d="M0 0h24v24H0V0z" fill="none"/>
                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
            </svg>
        </div>
    </div>
</ng-template>
